# H.E.L.E.N
H.E.L.E.N: Haplotype Embedded Long-read Error-corrector for Nanopore

<br/>
[![Build Status](https://travis-ci.com/kishwarshafin/helen.svg?branch=master)](https://travis-ci.com/kishwarshafin/helen)

`HELEN` is a polisher intended to use for polishing assemblies generated by [Shasta](https://github.com/chanzuckerberg/shasta) assembler. `HELEN` operates on the pileup summary generated by [MarginPolish](https://github.com/benedictpaten/marginPhase). `MarginPolish` uses a probabilistic graphical-model to encode read alignments through a draft assembly to find the maximum-likelihood consensus sequence. The graphical-model operates in run-length space which helps to reduce errors in homopolymeric regions. `MarginPolish` can produce tensor-like summaries encapsulating the internal likelihood weights assigned to each genomic position over multiple likely outcomes that is suitable for a Deep Neural Network model. `HELEN` uses a Recurrent-Neural-Network (RNN) based Multi-Task Learning (MTL) model that can predict a base and a run-length for each genomic position. The combination of `Shasta-MarginPolish-HELEN` produces state-of-the-art human genome assemblies constructed using Oxford Nanopore Sequencing Technology.

© 2019 Kishwar Shafin. <br/>
Computational Genomics Lab (CGL), University of California, Santa Cruz.

## Workflow
<p align="center">
<img src="img/pipeline.svg" alt="pipeline.svg" height="640p">
</p>

The pipeline to generate a high quality genomic assembly from Oxford Nanopore Sequencing data involves using Shasta, Minimap2, MarginPolish and HELEN.
* Generate an assembly with [Shasta](https://github.com/chanzuckerberg/shasta).
* Create a mapping between reads and the assembly using [Minimap2](https://github.com/lh3/minimap2).
* Use [MarginPolish](https://github.com/benedictpaten/marginPhase) to generate the images.
* Use HELEN to generate a polished consensus sequence.

## Results
Put some dope results here

## Installation
`HELEN` requires `cmake` and `python3` to be installed in the system.
```bash
sudo apt-get -y install cmake
sudo apt-get -y install python3
sudo apt-get -y install python3-dev
```
To install `HELEN`:

```bash
git clone https://github.com/kishwarshafin/helen.git
cd helen
./build.sh
```

This will install `HELEN` in your local system. `HELEN` also requires installing some python3 packages.
```bash
python3 -m pip install h5py tqdm numpy torchnet
```

##### Installing PyTorch
<b>Please follow the instructions from this [pytorch-installation-guide](https://pytorch.org/get-started/locally/) to install the right `PyTorch` version.<b/> <br/>

`HELEN` uses `PyTorch` as the deep-neural-network library. We suggest a careful installation of `PyTorch` with the right `CUDA` version. We highly recommend using `HELEN` on a GPU machine and we have made it easy to use on multiple GPUs. All you need is to install the right `PyTorch` package compiled against the right `CUDA` version and using `HELEN` is as simple as setting a flag `--gpu_mode 1`. We have tested these PyTorch versions against `HELEN` to ensure GPU accelerated inference:
* PyTorch 1.0 with CUDA 10.0
* PyTorch 1.1 with CUDA 10.0

## Usage
Full user documentation [Working on it]
## Help
Email address of someone helpful.

## Acknowledgement
We are thankful to the developers of these packages: </br>
* [pytorch](https://pytorch.org/)
* [ssw library](https://github.com/mengyao/Complete-Striped-Smith-Waterman-Library)
* [hdf5 python (h5py)](https://www.h5py.org/)
* [pybind](https://github.com/pybind/pybind11)


© 2019 Kishwar Shafin.
